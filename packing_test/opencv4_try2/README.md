# Incremetal build

- первый прогон можно оставить с неизмененным src 
- либо нужно подготовить исходники самому и разложить все правильно если мы хотим коммитить изменения кода
- патч можно наложить только если мы использовали git

```shell.nix
    src = builtins.fetchGit {
      shallow = true;
      url = ./debug/source; # without prebuild, only source
    };
```

- для этого можно использовать `make download`
- shell.nix позволит сбилдить проект с нужным флагами 
- при первой долгой компиляции нужно изменить скрипт так чтобы вытащить рабочую дирректорию с компиляцией

```shell.nix
    buildPhase = ''
      make -j$(nproc)
      echo Path:
      echo $out
      mkdir -p $out/build
      cp -r * $out/build
      false
    '';
```
- затем вручную скопировать все папки к себе в систему в любой удобный для вас путь

- после определить путь до этой папки в своей системе в src = , тогда компиляция будет проходить инкрементально

```shell.nix
src = /home/bg/code/debug/source;
```

- в конце `nix-shell --pure` должен происталить вашу модифицированную opencv в систему и можно будет компилировать
- прокты которые используют opencv и отлаживать
